<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CareSim Student Portal</title>
    <link rel="icon" type="image/png" sizes="32x32" href="asat.png">
    <link rel="icon" type="image/png" sizes="16x16" href="asat.png">
    <link rel="shortcut icon" type="image/png" href="asat.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="student-portal.css">
</head>
<body class="student-portal student-dashboard-page">
    <!-- Header / Navigation -->
    <header class="portal-header">
        <div class="header-content">
            <div class="logo">
                <a href="#" class="logo-link" onclick="event.preventDefault(); window.scrollTo({top: 0, behavior: 'smooth'}); return false;">
                <img src="caresimm.png" alt="CareSim" class="header-logo">
                </a>
            </div>
            <div class="header-right">
                <nav class="nav-tabs">
                    <a href="/student-dashboard" class="nav-tab active">Dashboard</a>
                    <a href="/student-lessons" class="nav-tab">Lessons</a>
                    <a href="/student-progress" class="nav-tab">Progress</a>
                    <a href="/student-class" class="nav-tab">Class</a>
                    <a href="/student-certificates" class="nav-tab">Certificates</a>
                    <a href="/student-profile" class="nav-tab">Profile</a>
                </nav>
                <button class="btn-logout" onclick="logout()">Logout</button>
            </div>
        </div>
    </header>
    <div class="portal-container">
        <!-- Student dashboard greeting header -->
        <section class="student-dashboard-header">
            <div class="dashboard-greeting">
                <h1 class="dashboard-greeting-title">
                    Hello, Student ðŸ‘‹
                </h1>
                <p class="dashboard-greeting-subtitle">
                    Hereâ€™s a quick overview of your CareSim LMS progress.
                </p>
            </div>
        </section>

        <div class="student-dashboard-layout">
            <section class="student-profile-card">
                <p class="profile-greeting" id="profileGreeting">STUDENT PROFILE</p>
                
                <!-- Top Section: Avatar + Name + Badge -->
                <div class="profile-header-section">
                    <div class="profile-photo">
                        <div class="photo-placeholder" id="profileInitial">?</div>
                    </div>
                    <div class="profile-name-badge-wrapper">
                        <h1 class="profile-name" id="profileName">Loading...</h1>
                        <div class="profile-status">
                            <span class="verified-badge" id="verifiedBadge" style="display: none;">
                                <svg class="icon-check" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M13.333 4L6 11.333 2.667 8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Verified Student
                            </span>
                        </div>
                    </div>
                </div>
                
                <!-- Bottom Section: Compact Info Grid -->
                <div class="profile-info-grid">
                    <div class="profile-info-item">
                        <div class="info-label">STUDENT NUMBER</div>
                        <div class="info-value" id="profileStudentNumber">â€”</div>
                    </div>
                    <div class="profile-info-item">
                        <div class="info-label">BATCH</div>
                        <div class="info-value" id="profileBatch">â€”</div>
                    </div>
                    <div class="profile-info-item">
                        <div class="info-label">PROGRAM / COURSE</div>
                        <div class="info-value" id="profileProgram">Caregiving NC II</div>
                    </div>
                    <div class="profile-info-item">
                        <div class="info-label">ASSIGNED INSTRUCTOR</div>
                        <div class="info-value" id="profileInstructor">Not assigned</div>
                    </div>
                    <div class="profile-info-item">
                        <div class="info-label">EMAIL</div>
                        <div class="info-value" id="profileEmail">â€”</div>
                    </div>
                    <div class="profile-info-item">
                        <div class="info-label">LAST LOGIN</div>
                        <div class="info-value" id="profileLastLogin">â€”</div>
                    </div>
                </div>
            </section>
            <!-- New student stats row (6 cards) -->
            <section class="student-stats-row">
                <div class="student-stat-card">
                        <div class="stat-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4 19.5C4 18.395 4.895 17.5 6 17.5H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M6 2H20V22H6V2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M6 7H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M6 12H14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                    <p class="stat-label">Lessons completed</p>
                    <p class="stat-value" id="stat-lessons-completed">0</p>
                    <p class="stat-caption">out of 6 lessons</p>
                        </div>
                <div class="student-stat-card">
                        <div class="stat-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9 11L12 14L22 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M21 12V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V5C3 3.89543 3.89543 3 5 3H16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                    <p class="stat-label">Assessments completed</p>
                    <p class="stat-value" id="stat-assessments-completed">0</p>
                    <p class="stat-caption">lesson pages passed</p>
                        </div>
                <div class="student-stat-card">
                        <div class="stat-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                            <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                    <p class="stat-label">Simulations passed</p>
                    <p class="stat-value" id="stat-simulations-passed">0</p>
                    <p class="stat-caption">LMS simulations</p>
                        </div>
                <div class="student-stat-card">
                        <div class="stat-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L15 8L22 9L17 14L18 21L12 18L6 21L7 14L2 9L9 8L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                    <p class="stat-label">Game lessons completed</p>
                    <p class="stat-value" id="stat-game-lessons-completed">0</p>
                    <p class="stat-caption">Unity game progress</p>
                        </div>
                <div class="student-stat-card">
                        <div class="stat-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                    <p class="stat-label">Game quiz average</p>
                    <p class="stat-value" id="stat-game-quiz-average">0.0</p>
                    <p class="stat-caption">Unity game quizzes (out of 10)</p>
                        </div>
                <div class="student-stat-card">
                        <div class="stat-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M3 3V21H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M7 16L12 11L16 15L21 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M21 10H15V16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                    <p class="stat-label">Overall progress</p>
                    <p class="stat-value" id="stat-overall-lms-progress">0%</p>
                    <p class="stat-caption">50% LMS + 50% Game</p>
                    </div>
            </section>
        </div>


        <!-- Legacy sections (overall progress, quick access, insights, certificates, announcements)
             remain in place but their contents are now driven by the new LMS dashboard data. -->
        <section class="progress-access-row">
            <div class="overall-progress-card">
                <div class="overall-progress-visual" id="overallProgressDonut">
                    <span id="overallProgressValue">0%</span>
                    </div>
                <!-- Updated right-hand content for Overall Course Progress -->
                <div class="overall-progress-details">
                    <h3 class="overall-progress-title">Overall course progress</h3>
                    <p class="overall-progress-subtitle">Stay motivatedâ€”you're on track!</p>
                    <div class="overall-progress-sections">
                        <div class="overall-progress-section">
                            <h4 class="section-heading">LMS</h4>
                            <div class="section-row">
                                <span class="section-label">Lessons</span>
                                <span class="section-value" id="stat-lms-lessons">0 / 0</span>
                            </div>
                            <div class="section-row">
                                <span class="section-label">Assessments</span>
                                <span class="section-value" id="stat-lms-assessments">0 / 0</span>
                            </div>
                        </div>
                        <div class="overall-progress-section">
                            <h4 class="section-heading">Game</h4>
                            <div class="section-row">
                                <span class="section-label">Quiz</span>
                                <span class="section-value" id="stat-game-quizzes">0 / 6</span>
                            </div>
                            <div class="section-row">
                                <span class="section-label">Simulation</span>
                                <span class="section-value" id="stat-game-simulations">0 / 6</span>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>
            <div class="quick-access-grid">
                <button class="quick-card quick-card-blue" id="continueLessonCard">
                    <div class="quick-card-icon-wrapper">
                        <svg class="icon-book" width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4 19.5C4 18.395 4.895 17.5 6 17.5H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M6 2H20V22H6V2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M6 7H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M6 12H14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="quick-card-content">
                        <h3 class="quick-card-title">Continue Lesson</h3>
                        <p class="quick-card-subtitle">Jump back to where you left off</p>
                        <p class="quick-card-action-text" id="continueLessonBack" style="display: none;">Resume Lesson 5</p>
                    </div>
                </button>
                <button class="quick-card quick-card-green" id="myAssessmentsCard">
                    <div class="quick-card-icon-wrapper">
                        <svg class="icon-quiz" width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9 11L12 14L22 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M21 12V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V5C3 3.89543 3.89543 3 5 3H16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="quick-card-content">
                        <h3 class="quick-card-title">My Assessments</h3>
                        <p class="quick-card-subtitle">View your pending and completed assessments</p>
                        <p class="quick-card-action-text">Go to assessments</p>
                    </div>
                </button>
                
                <button class="quick-card quick-card-purple" id="viewCertificatesCard">
                    <div class="quick-card-icon-wrapper">
                        <svg class="icon-graduation" width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M22 10V6C22 4.89543 21.1046 4 20 4H4C2.89543 4 2 4.89543 2 6V18C2 19.1046 2.89543 20 4 20H12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M2 10H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M15 2V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M9 2V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M16 14L18 16L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="quick-card-content">
                        <h3 class="quick-card-title">View Certificates</h3>
                        <p class="quick-card-subtitle">See what you've earned so far</p>
                        <p class="quick-card-action-text">Open certificates</p>
                    </div>
                </button>
                <button class="quick-card quick-card-peach" id="downloadAppCard">
                    <div class="quick-card-icon-wrapper">
                        <svg class="icon-download" width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21 15V19C21 20.1046 20.1046 21 19 21H5C3.89543 21 3 20.1046 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="quick-card-content">
                        <h3 class="quick-card-title">Download CareSim App</h3>
                        <p class="quick-card-subtitle">Install the mobile game on your device</p>
                        <p class="quick-card-action-text">Download APK</p>
                    </div>
                </button>
            </div>
        </section>

            <div id="verificationBanner" class="verification-banner" style="display: none;">
                <div class="banner-content">
                <span class="banner-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                        <circle cx="12" cy="12" r="6" stroke="currentColor" stroke-width="2"/>
                        <circle cx="12" cy="12" r="2" fill="currentColor"/>
                    </svg>
                </span>
                    <p>Complete your profile to become a Verified CareSim Student and unlock special game rewards!</p>
                    <button class="btn-banner" onclick="goToProfile()">Go to Profile</button>
                </div>
            </div>

            <section class="lessons-section">
            <div class="section-heading">
                <h1 class="section-title">Lesson Progress</h1>
            </div>
                <div class="lessons-grid" id="lessonsContainer">
                    <!-- Lesson cards will be inserted here -->
                </div>
            </section>

        <section class="lesson-progress-panels">
            <div class="your-lessons-panel">
                <div class="panel-header">
                    <h2 class="panel-title">Your Lessons</h2>
                </div>
                <div class="panel-body">
                    <div id="yourLessonsContent">
                        <!-- Lesson cards/rows will be inserted here -->
                            </div>
                        </div>
                            </div>
            <div class="upcoming-tasks-panel">
                <div class="panel-header">
                    <h2 class="panel-title">Upcoming Tasks</h2>
                            </div>
                <div class="panel-body">
                    <div id="upcomingTasksContent">
                        <!-- Task items will be inserted here -->
                        </div>
                </div>
            </div>
        </section>

        <section class="announcements-section">
            <div class="announcements-card">
                <div class="announcements-header">
                    <div class="announcements-header-left">
                        <h2 class="announcements-title">Announcements</h2>
                        <p class="announcements-subtitle">Stay updated with your instructor.</p>
                    </div>
                    <button class="announcements-view-all" onclick="viewAllAnnouncements()">View All</button>
                </div>
                <div class="announcements-feed" id="announcementsList">
                    <!-- Announcements will be inserted here -->
                </div>
            </div>
            </section>
    </div>
    <!-- Logout Confirmation Modal -->
    <div id="logoutModal" class="history-modal" style="display: none !important;">
        <div class="history-modal-content logout-modal-content">
            <div class="history-modal-header">
                <h2>Confirm Logout</h2>
                <button class="history-close" onclick="closeLogoutModal()">&times;</button>
            </div>
            <div class="logout-modal-body">
                <p>Are you sure you want to log out?</p>
            </div>
            <div class="modal-actions" style="padding: 20px 24px; border-top: 1px solid #E5E7EB; display: flex; justify-content: flex-end; gap: 12px;">
                <button type="button" class="btn-secondary" onclick="closeLogoutModal()" style="padding: 10px 20px; background: white; color: #64748B; border: 1px solid #E2E8F0; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s;">Cancel</button>
                <button type="button" class="btn-primary" onclick="confirmLogout()" style="padding: 10px 20px; background: #C19A6B; color: white; border: none; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s;">Logout</button>
            </div>
        </div>
    </div>
    <!-- History Modal -->
    <div id="historyModal" class="history-modal" style="display: none;">
        <div class="history-modal-content">
            <div class="history-modal-header">
                <h2 id="historyTitle">Quiz History</h2>
                <button class="history-close" onclick="closeHistoryModal()">&times;</button>
            </div>
            <div class="history-modal-body">
                <div class="history-list" id="historyList">
                    <!-- History items will be inserted here -->
                </div>
            </div>
        </div>
    </div>
    <!-- Student dashboard logic -->
    <script src="/js/student-dashboard.js"></script>
    <!-- Alert Modal -->
    <div id="alertModal" class="history-modal" style="display: none;">
        <div class="history-modal-content">
            <div class="history-modal-header">
                <h2 id="alertTitle">Notice</h2>
                <button class="history-close" onclick="closeAlertModal()">&times;</button>
            </div>
            <div class="history-modal-body">
                <p id="alertMessage"></p>
            </div>
            <div class="modal-actions" style="padding: 20px 24px; border-top: 1px solid #E5E7EB; display: flex; justify-content: flex-end; gap: 12px;">
                <button type="button" class="btn-primary" onclick="closeAlertModal()" style="padding: 10px 20px; background: #C19A6B; color: white; border: none; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s;">OK</button>
            </div>
        </div>
    </div>
    <script>
        function showAlertModal(message, title = 'Notice') {
            const modal = document.getElementById('alertModal');
            if (!modal) return alert(message);
            const titleEl = document.getElementById('alertTitle');
            const msgEl = document.getElementById('alertMessage');
            if (titleEl) titleEl.textContent = title;
            if (msgEl) msgEl.textContent = message;
            modal.style.display = 'flex';
        }
        function closeAlertModal() {
            const modal = document.getElementById('alertModal');
            if (modal) modal.style.display = 'none';
        }
    </script>

    <!-- APK Download Modal -->
    <div class="apk-download-modal-backdrop" id="apk-download-modal" aria-hidden="true">
        <div class="apk-download-modal">
            <h2 class="apk-modal-title">Download CareSim App</h2>
            <p class="apk-modal-text">
                You'll be redirected to Google Drive to download the CareSim Android APK file
                (<strong>caresim.apk</strong>). After downloading, open it on your device
                and follow the installation steps.
            </p>
            <p class="apk-modal-note">
                Make sure you trust this device and allow installation from this source.
            </p>
            <p class="apk-modal-helper-text">
                You can copy this link and send it via Messenger or email to download CareSim on another device.
            </p>
            <div class="apk-modal-link-box">
                <input type="text" class="apk-modal-link-input" id="apk-modal-link-input" value="https://drive.google.com/file/d/1Fyv9TuEB8jiB-bJJgTS5wnvzYW1mIhhE/view?usp=sharing" readonly>
                <button type="button" class="apk-modal-copy-btn" id="apk-modal-copy-link" title="Copy link">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" id="apk-copy-icon">
                        <path d="M16 1H4C2.9 1 2 1.9 2 3V17H4V3H16V1ZM19 5H8C6.9 5 6 5.9 6 7V21C6 22.1 6.9 23 8 23H19C20.1 23 21 22.1 21 21V7C21 5.9 20.1 5 19 5ZM19 21H8V7H19V21Z" fill="currentColor"/>
                    </svg>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" id="apk-copy-check" style="display: none;">
                        <path d="M9 16.17L4.83 12L3.41 13.41L9 19L21 7L19.59 5.59L9 16.17Z" fill="currentColor"/>
                    </svg>
                </button>
            </div>
            <div class="apk-modal-actions">
                <button type="button" class="apk-modal-btn apk-modal-btn-secondary" id="apk-modal-cancel">
                    Cancel
                </button>
                <a href="https://drive.google.com/file/d/1Fyv9TuEB8jiB-bJJgTS5wnvzYW1mIhhE/view?usp=sharing" class="apk-modal-btn apk-modal-btn-primary" id="apk-modal-confirm" target="_blank" rel="noopener noreferrer">
                    Download APK
                </a>
            </div>
        </div>
    </div>
    
</body>
</html>
